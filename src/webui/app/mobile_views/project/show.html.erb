<%
@nr_packages = 0
@nr_packages = @packages.each.size if @packages
-%>

<h3><%=h @project.title %><%=  h( @project ) if @project.title.to_s.blank? -%></h3>

<% description = @project.description.text %>
<% unless description.blank? %>
  <div data-role="collapsible" data-collapsed="true">
    <h3>Description</h3>
    <p>
      <% description.split( /\n/ ).each do |line| %>
        <%=h line -%><br/>
      <% end %>
    </p>
  </div>
<% end -%>

<% if @nr_packages > 0 %>
  <div data-role="collapsible" data-collapsed="true">
    <h3>Packages (<%= @nr_packages %>)</h3>
    <ul data-role="listview" data-inset="true">
      <% i = 0 %>
      <% @packages.each do |package| -%>
        <% i = i + 1 %>
        <% break if i > 200 %>
        <li><%= link_to package.name, :controller => :package, :action => :show, :project => @project, :package => package %></li>
      <% end -%>
      <%= raw "<li>... (only showing the first 200)</li>" if @nr_packages > 200 %>
    </ul>
  </div>
<% end -%>

<% if @project.has_element?(:repository) && !@buildresult.blank? %>
  <div data-role="collapsible" data-collapsed="true">
    <h3>Build Status</h3>
    <div id='buildstatus'>
      <%=  render :partial => 'buildstatus' %>
    </div>
  </div>
<% end -%>

