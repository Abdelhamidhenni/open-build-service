<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="Content-Script-Type" content="text/javascript"/>
    <meta http-equiv="Content-Style-Type" content="text/css"/>

    <link href="<%= CONFIG['relative_url_root'] %>/favicon.ico" rel="shortcut icon" />

    <title><%=h "#{@pagetitle} - " if @pagetitle -%>openSUSE Build Service</title>

    <%= stylesheet_link_tag "/themes/bento/css/style", :media => "screen", :title => "All" %>
    <%= stylesheet_link_tag "local/style", :media => "screen", :title => "All" %>
    <%= javascript_include_tag '/themes/bento/js/jquery.js', 'jquery-ui-1.7.2.min' %>
    <%= javascript_include_tag 'jrails', "application" %>
    <%= javascript_include_tag '/themes/bento/js/script' %>
    <%= javascript_include_tag '/themes/bento/js/l10n/global-navigation-data-en_US.js' %>
    <%= javascript_include_tag '/themes/bento/js/global-navigation' %>
    <%= javascript_include_tag 'favorites' %>

    <%= yield :content_for_head %>

    <script type="text/javascript">
        <%= yield :head_javascript %>
        <%= yield :ready_function %>
    </script>

  </head>

  <body>

    <div id="dialog_wrapper" style="display: none"></div>

    <!-- Start: Header -->
    <div id="header">

      <div id="header-content" class="container_12">

        <a id="header-logo" href="#">
          <%= image_tag( "/themes/bento/images/header-logo.png" ) %>
        </a>

      <ul id="global-navigation">
        <li id="item-downloads"><a href="http://opensuse.org/sitemap#downloads">Downloads</a></li>
        <li id="item-support"><a href="http://opensuse.org/sitemap#support">Support</a></li>
        <li id="item-community"><a href="http://opensuse.org/sitemap#community">Community</a></li>
        <li id="item-development"><a href="http://opensuse.org/sitemap#development">Development</a></li>
          <% if user -%>
            <li id="global-favorites"><a href="#">Watchlist</a></li>
          <% end -%>
        </ul>

        <% if user -%>
          <ul class="global-navigation-menu global-navigation-menu-favorites" id="menu-favorites">
            <li>
              <a href="<%= url_for :controller => "project", :action => :list_my %>">
              <div>Watchlist ...</div>
              <div class="desc">Your watched and involved projects</div></a></li>
            <% if user && user.has_element?( 'watchlist' ) -%>
              <% user.watchlist.each_project.map {|p| p.name}.sort {|a,b| a.downcase <=> b.downcase}.each do |project|-%>
                <li id="watchlist_<%= Digest::MD5.hexdigest project %>">
                  <a href="<%= url_for :controller => 'project', :action => :show, :project => project %>">
                  <div><%= project %></div></a>
                </li>
              <% end -%>
            <% end -%>
          </ul>
        <%- end -%>


        <form id="global-search-form" action="" method="post" accept-charset="utf-8">
          <div style="display: inline">
            <input type="text" name="q" value="search" id="search" />
            <input type="submit" value="Search" class="hidden" />
          </div>
        </form>

      </div>
    </div>
    <!-- End: Header -->

    <div id="subheader" class="container_16">
      <div id="breadcrump" class="grid_12 alpha">
        <%= image_tag( "/themes/bento/images/home_grey.png" ) %><%= link_to "Build Service", :controller => 'main', :action => :index %>
        <% if @crumb_list -%>
          <% @crumb_list.each do |link| -%>
            &gt; <%= link %>
          <% end -%>
        <% end -%>
      </div>

      <%= render :partial => "layouts/personal_navigation"  %>
    </div>

    <%= render(:partial => "layouts/flash", :object => flash) %>

    <!-- Start: Main Content Area -->
    <div id="content" class="container_16 content-wrapper">
      <% if @layouttype == "custom" %>
        <%= @content_for_layout %>
      <% else %>
        <div class="grid_16 box box-shadow alpha omega">
          <%= @content_for_layout %>
        </div>
      <% end %>
    </div>
    <!-- End: Main Content Area -->


    <!-- Start: Footer -->
    <div id="footer" class="container_12">
      <% if session[:login] -%>
        <div class="box_content grid_3">
          <strong class="grey-medium spacer1">User: <%= link_to session[:login], :controller => 'home', :action => :index %></strong>
          <ul class="navlist">
            <li><%= link_to "My Projects", :controller => "project", :action => :list_my %></li>
            <li><%= link_to "My Requests", :controller => "request", :action => :list_req %></li>
            <li><%= link_to "Home Project", :controller => 'project', :action => :show, :project => "home:#{session[:login]}" %></li>
            <li><%= link_to 'Logout', :controller => 'user', :action => 'logout' %></li>
          </ul>
        </div>
      <% end -%>

      <div class="box_content grid_3">
        <strong class="grey-medium spacer1">Locations</strong>
        <ul>
          <li><%= link_to "Projects", :controller => "project", :action => :list_public %></li>
          <li><%= link_to "Search", :controller => 'main', :action => 'search' %></li>
          <li><%= link_to "Server Status", :controller => "monitor", :action => :index %></li>
        </ul>
      </div>

      <div class="box_content grid_3">
        <strong class="grey-medium spacer1">Help</strong>
        <ul>
          <% @helplinks = [
            { 'Wiki Pages'  => 'http://en.opensuse.org/Build_Service' },
            { 'Building Packages'  => 'http://en.opensuse.org/SUSE_Build_Tutorial' },
            { 'Writing spec Files' => 'http://en.opensuse.org/Packaging/SUSE_Package_Conventions' },
            { 'Reporting a Bug'   => 'http://en.opensuse.org/Submit_a_Bug' },
            { 'Forums'             => 'http://forums.opensuse.org/opensuse-build-service-obs/' } ]

          @helplinks.each do |helplink|
            for k in helplink.keys %>
              <li><a href="<%= helplink[k] -%>"><%= k %></a></li>
            <% end %>
          <% end %>
        </ul>
      </div>

      <%= render(:partial => "layouts/sponsor") %>

      <div id="footer-legal" class="border-top grid_12">
        <p>
          &copy; 2010 Novell, Inc. All rights reserved. Novell is a registered trademark and
          openSUSE and SUSE are trademarks of Novell, Inc. in the United States and other countries.
          <a style="float: right" href="http://www.totalvalidator.com/validator/Revalidate?revalidate=true&amp;dtd=dtds/1.0/xhtml1-strict.dtd&amp;pages=1&amp;wai=&amp;url=http://<%= request.env['HTTP_HOST']%><%= h request.request_uri %>">
            <%= image_tag "valid_sn_xhtml_10.gif", :alt=>"Totally Valid XHTML 1.0" %>
          </a>
        </p>
      </div>

    </div>
    <!-- End: Footer -->


  </body>
</html>
