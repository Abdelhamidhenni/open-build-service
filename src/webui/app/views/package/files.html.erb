
<% @pagetitle = "Files of Package #{@package} (Project #{@project})" %>
<% package_bread_crumb 'Files' -%>

<%= render :partial => "tabs" %>

<% content_for :content_for_head do %>
  <%= javascript_include_tag 'jquery.tablesorter.js' %>
<% end %>

<% content_for :head_javascript do %>


  function insertRow() {
    var name     = document.getElementById('add_new_parameter').value;
    var service  = document.getElementById('servicename').value;
    var value    = document.getElementById('add_new_value').value;
    var number   = document.getElementById('count_parameters').value + 1;

    $('#pTable tr:last').before('<tr class=\"row_'+number+'\">'+
      '<td>'+name+'</td>'+
      '<td id="added_parameter_'+number+'">...</td>'+
      '<td><a href=\"#\" onclick=\"\$(\'tr.row_'+number+'\').remove(); return false;\">X</a></td>'+
      '</tr>');
    
    document.getElementById('count_parameters').value = number;

    var path="/package/service_parameter_value?number="+number+"&servicename="+escape(service)+"&parameter="+escape(name)+"&value="+escape(value)+"&package=<%=@package%>&project=<%=@project%>";
    $("#pTable td#added_parameter_"+number).load(path);
  }

<% end %>


<% content_for :ready_function do %>
  $("#files_table").tablesorter( {
    sortList: [[0,1]],
    widgets: ['zebra'],
    headers: {
      3: { sorter: false }
    }
  } );
<% end %>


<%= render :partial => 'links' if @link %>

<!-- Service list -->
<h3>Source Services</h3>
<%= render :partial => 'services' %>

<!-- Source file list -->
<h3>Source Files <%= image_tag('ajax-loader.gif', :id => 'spinner_files', :class => 'hidden') %>
<span style="font-size: small; font-weight: normal">
  <% if @expand && @link %>
    <%= link_to '(show unmerged sources)', :project => @project, :package => @package, :action => :files, :rev => params[:rev] %>
  <% elsif @link %>
    <%= link_to '(show merged sources derived from linked package)', :project => @project, :package => @package, :action => :files, :rev => params[:rev], :expand => "1" %>
  <% end %>
</span>
</h3>

<% unless @files.empty? %>
  <%= render :partial => 'files_view', :locals => {:file_list => @files} %>
<% end %>

