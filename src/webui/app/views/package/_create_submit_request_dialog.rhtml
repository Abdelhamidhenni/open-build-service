
<%= javascript_include_tag 'jquery.autocomplete.pack' %>
<%= stylesheet_link_tag 'jquery.autocomplete' %>

<script type="text/javascript">
  $("#target_project").autocomplete('<%= url_for :controller => :project, :action => :autocomplete_projects %>',
    { minChars: 2, matchCase: true, max: 50 } );

  $("#target_package").autocomplete('<%= url_for :controller => :project, :action => :autocomplete_packages %>', {
    minChars: 0, matchCase: true, max: 50,
    extraParams: {
       project: function() { return $("#target_project").val(); }
    }
  });
  </script>

<div id="dialog_wrapper">

<div class="dialog" id="disable_mask"></div>
<div class="dialog darkgrey_box" id="create_submit_request">
  <div class="box box-shadow">
    <div class="box-header aligncenter">
      <b>Create submit request</b>
    </div>

    <% tprj = ""
       tpkg = @package.name
       if @package.linkinfo
         tprj = @package.linkinfo.project
         tpkg = @package.linkinfo.package
       end
     %>

    <div class="aligncenter buttons">
    <%= form_tag({:controller => "package", :action => "create_submit_request"}, :method => "post") %>
       <%= hidden_field_tag(:project, @project) %>
       <%= hidden_field_tag(:package, @package) %>
       <%= hidden_field_tag(:revision, @revision) %>
       <% prjname = @project.name
          prjname = prjname[0..40] + "..." if @project.name.length > 40 -%>
       Submit <%= prjname %> / <%= @package %> in revision <%= @revision %> to

    <p>
       Target project: <input type="text" name="target_project" value="<%=tprj%>" id="target_project" /><br/>
<!-- do not confuse the user with target package name
       Package: <input type="text" name="target_package" value="<%=tpkg%>" id="target_package" />
-->
       </p>
       <p>
       <i>Request description:</i>
       <textarea rows="3" cols="40" name="description"></textarea>
       </p>
       <% default = "update" %>
       <% default = "cleanup" if "home:#{session[:login]}:branches:#{tprj}" == @project.to_s %>
       <%= check_box_tag :source_update, 'cleanup' %> Remove my package on acceptance
       <p>
       <input type="submit" value="Submit" />
       </p>
     </form>
    </div>

    <p><div class="aligncenter buttons">
        <%= link_to_function 'Cancel', 'remove_dialog()'%>
    </div></p>


  </div>

</div></div>
